program: src/main.py
method: bayes
run_cap: 5
metric:
  name: avg_acc
  goal: maximize

parameters:
  dataset:
    value: mnist
  scenario:
    value: domain_inc
  model:
    value: mlp
  method:
    value: composer_ewc
  exp.seed: 
    values: [42, 1, 2, 3, 4]
  exp.batch_size:
    value: 512
  exp.epochs: 
    value: 10
  exp.gen_cm: 
    value: False
  exp.detect_anomaly:
    value: False
  fabric.accelerator:
    value: gpu   
  exp.log_per_batch:
    value: False
  exp.cleanup:
    value: True
  exp.dil:
    value: True


  # Scenario configuration
  scenario._partial_:
    value: True
  scenario._target_:
    value: scenario.DomainIncremental
  scenario.increment:
    value: 2

  # Model configuration
  model._target_: 
    value: model.MLP
  model.initial_out_features:
    value: 2          
  model.sizes:
    value: [1024, 400, 400]
  model.head_type: 
    value: Normal
  model.layers: 
    value: ["Normal", "Normal"]
  model.activation: 
    value: torch.nn.ReLU
  model.mask_past_classifier_neurons:
    value: False 

  # Method configuration
  method._partial_: 
    value: True
  method._target_: 
    value: method.Composer
  method.criterion: 
    value: CrossEntropyLoss
  method.criterion_scale:
    value: 0.019633215660269276
  
  method.lr: 
    value: 0.00011245101576303444
  method.ema_scale:
    value: 0.95

  method.plugins.0._target_:
    value: method.EWC
  method.plugins.0.alpha: 
    value: 7750.262515109786
  method.plugins.0.head_opt:
    value: True


command:
  - ${env}
  - python
  - ${program}
  - --config-name
  - ewc_split_mnist_mlp.yaml
  - ${args_no_hyphens}